# HealthAI 앱 테스트 가이드

**작성일:** 2025년 12월 10일
**목적:** 구현된 백엔드 기능을 Flutter 앱에서 확인하기

---

## 📋 구현 완료된 기능

### 1. 백엔드 API (테스트 서버)

#### 실행 중인 서비스
- **URL:** http://localhost:8002
- **API 문서:** http://localhost:8002/docs
- **상태:** ✅ 실행 중

#### 구현된 API 엔드포인트
```
GET  /health                              - 서버 상태 확인
GET  /api/v1/characters                   - 모든 AI 캐릭터 조회
GET  /api/v1/characters/{id}              - 특정 캐릭터 조회
GET  /api/v1/characters/{id}/introduction - 캐릭터 자기소개 오디오 (MP3)
GET  /static/character_intros/*.mp3       - Static 파일 직접 접근
```

#### 캐릭터 데이터 (6명)
1. **박지훈** (park_jihoon) - 내과 전문의, 남성, onyx 음성
2. **최현우** (choi_hyunwoo) - 정신건강의학과, 남성, echo 음성
3. **오경미** (oh_kyungmi) - 영양사, 여성, nova 음성
4. **이수진** (lee_soojin) - 여성건강, 여성, shimmer 음성
5. **박은서** (park_eunseo) - 소아청소년과, 여성, alloy 음성
6. **정유진** (jung_yujin) - 노인의학과, 여성, shimmer 음성

---

### 2. Flutter 앱 통합

#### 새로 생성된 파일
```
lib/
├── core/
│   ├── models/
│   │   └── character_model.dart          # 캐릭터 데이터 모델
│   └── services/
│       └── character_api_service.dart     # API 서비스 계층
└── features/
    └── character/
        └── screens/
            └── character_selection_screen.dart  # 캐릭터 선택 화면
```

#### 수정된 파일
- `pubspec.yaml` - http, just_audio 패키지 추가
- `lib/core/router/app_router.dart` - /characters 라우트 추가
- `lib/features/home/screens/home_screen.dart` - FAB에 캐릭터 선택 버튼 추가

---

## 🚀 앱 실행 및 테스트 방법

### 1. 백엔드 서버 실행 (이미 실행 중)

```bash
cd D:/Dev_project/AI_Voice_Healthdoctor/healthai-backend
python test_server.py
```

**확인:** http://localhost:8002/health 접속 시 `{"status":"healthy"}` 응답

---

### 2. Flutter 앱 실행

```bash
cd D:/Dev_project/AI_Voice_Healthdoctor/healthai_app
flutter run
```

**참고:**
- Windows: Chrome 브라우저 또는 Windows 데스크톱 앱으로 실행
- Android/iOS: 에뮬레이터 또는 실제 기기 연결 필요

---

### 3. 앱에서 테스트할 기능

#### ✅ 테스트 1: 캐릭터 목록 조회
1. 앱 실행 후 홈 화면에서 **"AI 주치의 선택"** 버튼 클릭
2. 6명의 AI 캐릭터 카드가 표시되는지 확인
3. 각 캐릭터의 다음 정보가 표시되는지 확인:
   - 이름 (한글)
   - 성별 배지 (남성/여성)
   - 전문 분야
   - 세부 전문 분야
   - 경력 년수
   - 자기소개 텍스트

**예상 결과:**
```
[박지훈]  [남성]
내과
만성질환 관리 (당뇨, 고혈압, 고지혈증)
경력 20년
안녕하세요, 내과 전문의 박지훈입니다...
```

---

#### ✅ 테스트 2: 캐릭터 자기소개 오디오 재생
1. 캐릭터 선택 화면에서 각 캐릭터 카드의 **재생 버튼** (▶️) 클릭
2. 오디오가 재생되는지 확인
3. 재생 중일 때 버튼이 **정지 버튼** (⏹️)으로 변경되는지 확인
4. 다시 클릭하면 오디오가 정지하는지 확인
5. 다른 캐릭터의 재생 버튼을 클릭하면 이전 오디오가 정지되고 새 오디오가 재생되는지 확인

**확인할 음성:**
- 박지훈, 최현우: 남성 음성 (깊고 차분 / 따뜻함)
- 오경미, 이수진, 박은서, 정유진: 여성 음성 (다양한 톤)

---

#### ✅ 테스트 3: 캐릭터 카드 클릭 (향후 구현)
1. 캐릭터 카드를 클릭
2. 현재는 대화 화면으로 이동 시도 (아직 미구현)
3. 에러 발생 시 정상 (대화 화면은 다음 단계에서 구현)

---

## 🔧 문제 해결 (Troubleshooting)

### 문제 1: "캐릭터를 불러올 수 없습니다" 에러
**원인:** 백엔드 서버가 실행되지 않음
**해결:**
```bash
cd D:/Dev_project/AI_Voice_Healthdoctor/healthai-backend
python test_server.py
```

---

### 문제 2: 오디오가 재생되지 않음
**원인:** 오디오 파일이 없거나 경로가 잘못됨
**확인:**
```bash
dir D:\Dev_project\AI_Voice_Healthdoctor\healthai-backend\static\character_intros
```
6개의 MP3 파일이 있어야 함:
- park_jihoon_intro.mp3
- choi_hyunwoo_intro.mp3
- oh_kyungmi_intro.mp3
- lee_soojin_intro.mp3
- park_eunseo_intro.mp3
- jung_yujin_intro.mp3

---

### 문제 3: Lottie 애니메이션이 표시되지 않음
**원인:** Lottie JSON 파일 경로 문제
**참고:** 현재는 기본 아이콘으로 표시됨 (정상)
**향후:** Lottie 파일을 `/assets`에 복사하고 pubspec.yaml에 등록

---

## 📱 예상 화면 구성

### 홈 화면
```
┌─────────────────────────────────────┐
│  음성 AI 건강주치의          🔔 ⚙️   │
├─────────────────────────────────────┤
│                                     │
│  좋은 오후에요 ☕                    │
│  오늘도 건강한 하루 보내세요         │
│                                     │
│  [가족 프로필 섹션]                  │
│  [AI 캐릭터 섹션]                    │
│  [최근 활동]                         │
│                                     │
└─────────────────────────────────────┘
              [🎤 AI 주치의 선택]
```

### 캐릭터 선택 화면
```
┌─────────────────────────────────────┐
│  ← AI 주치의 선택                    │
├─────────────────────────────────────┤
│  ┌───────────────────────────────┐  │
│  │ [아바타]  박지훈  [남성]  ▶️  │  │
│  │          내과               │  │
│  │          만성질환 관리      │  │
│  │          경력 20년          │  │
│  └───────────────────────────────┘  │
│  ┌───────────────────────────────┐  │
│  │ [아바타]  최현우  [남성]  ▶️  │  │
│  │          정신건강의학과     │  │
│  └───────────────────────────────┘  │
│  ...                                │
└─────────────────────────────────────┘
```

---

## 🎯 다음 단계 작업

구현 완료 후 다음 단계로 진행할 작업:

1. **WebSocket 음성 대화 기능**
   - Conversation Screen 구현
   - 실시간 오디오 스트리밍
   - OpenAI Realtime API 연동

2. **RAG 시스템 통합**
   - 의료 지식 검색 UI
   - 대화 중 관련 정보 표시

3. **OAuth 소셜 로그인**
   - Kakao, Google, Apple 로그인 버튼
   - 토큰 관리

4. **Health Plugin 업데이트**
   - Flutter Health 13.x 마이그레이션
   - 건강 데이터 동기화 테스트

---

## ✅ 완료 체크리스트

- [x] 백엔드 테스트 서버 실행
- [x] 캐릭터 API 구현
- [x] 캐릭터 TTS 오디오 생성 (6개)
- [x] Flutter 캐릭터 모델 생성
- [x] Flutter API 서비스 계층 구현
- [x] 캐릭터 선택 화면 UI 구현
- [x] 오디오 재생 기능 구현
- [x] 라우터 연동
- [ ] Flutter 앱 실행 및 테스트
- [ ] 실제 디바이스에서 테스트

---

## 📞 문의 및 버그 리포트

문제가 발생하면 다음 정보와 함께 보고:
1. 발생한 에러 메시지
2. 재현 방법
3. 기기 정보 (OS, 브라우저 등)
4. 스크린샷 (가능한 경우)

---

**작성자:** Claude AI (task-orchestrator)
**마지막 업데이트:** 2025-12-10 03:45 KST
